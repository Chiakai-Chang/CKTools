# Chiakai's 科偵軍火庫
* [![Hits](https://hits.sh/chiakai-chang.github.io/CKTools.svg?style=for-the-badge&label=%E7%80%8F%E8%A6%BD%E4%BA%BA%E6%AC%A1)](https://hits.sh/chiakai-chang.github.io/CKTools/)
* 更新至 2024-10-30 
* [**【建議與問題回饋請點我】**](https://forms.gle/euDVcKwk7QsiHgsz8)
---

## <span style="background-color:yellow;"> ☆☆☆ 本軍火庫各時段使用情形分布熱度圖 ☆☆☆ </span>

<iframe width="75%" height="100%" src="https://lookerstudio.google.com/embed/reporting/494c202f-7727-4a3e-9964-f2b1870946f8/page/gIeDE" frameborder="0" style="border:0" allowfullscreen sandbox="allow-storage-access-by-user-activation allow-scripts allow-same-origin allow-popups allow-popups-to-escape-sandbox"></iframe>

---

# <span style="background-color:yellow;"> ☆☆☆ 溫馨提醒您 ☆☆☆ </span>
* 本軍火庫內之各項 **Colab** 或 **Google Sheet** 之工具，相關程式碼或設定全部都係開源透明的，歡迎取用、修改或[回饋改進意見](https://forms.gle/euDVcKwk7QsiHgsz8)。
* <span style="color:red;">**請先記得將工具複製到您的帳號再運作唷!**</span>
  * ### Colab 複製方法:
    * 左上角「**檔案**」->「**在雲端硬碟中儲存副本**」
  * ### Google Sheet 複製方法:
    * 左上角「**檔案**」->「**建立副本**」

---

# <span style="background-color:yellow;"> ☆☆☆ 重磅推薦 ☆☆☆ </span>
* ## [AI Insight Seeker 智慧偵查筆記系統](https://chiakai.pse.is/AIInsightSeeker)
[![](https://chiakai-chang.github.io/tempHTML/img/Logo_AIInsightSEEKER_small.png)](https://chiakai.pse.is/AIInsightSeeker)
  * <p xmlns:cc="http://creativecommons.org/ns#" xmlns:dct="http://purl.org/dc/terms/"><a property="dct:title" rel="cc:attributionURL" href="https://chiakai.pse.is/AIInsightSeeker">AI Insight Seeker 智慧偵查筆記系統</a> by <a rel="cc:attributionURL dct:creator" property="cc:attributionName" href="https://www.linkedin.com/in/chiakai-chang-htciu">Chang, Chia-kai</a> is licensed under <a href="https://creativecommons.org/licenses/by-nc/4.0/?ref=chooser-v1" target="_blank" rel="license noopener noreferrer" style="display:inline-block;">CC BY-NC 4.0<img style="height:22px!important;margin-left:3px;vertical-align:text-bottom;" src="https://mirrors.creativecommons.org/presskit/icons/cc.svg?ref=chooser-v1" alt=""><img style="height:22px!important;margin-left:3px;vertical-align:text-bottom;" src="https://mirrors.creativecommons.org/presskit/icons/by.svg?ref=chooser-v1" alt=""><img style="height:22px!important;margin-left:3px;vertical-align:text-bottom;" src="https://mirrors.creativecommons.org/presskit/icons/nc.svg?ref=chooser-v1" alt=""></a></p>
  * 隨著資訊爆炸、新興科技飛速演進，致使網路犯罪案件激增，員警負荷過載，傳統偵查模式面臨挑戰。本作品設計並實作一套以協作為基礎的偵查管理平台，旨在解決資訊過載及知識碎片化問題。該系統平臺藉由 Google Sheets 強大的共用協作功能，適用於跨區域、跨國偵查，實現偵查工作的即時分配、進度追蹤及資料結構化等管理。透過高度整合且自動化的管理工具，有效提升自身偵查小隊或跨團隊間的協同合作、偵查過程情資共享透明度、同步協作效率及資訊共享準確性。
    * ※ 相關學術論文撰寫中。
  * **核心特色**
    * **智慧型洞察與管理**：<br>
      透過整合的儀表板，AI Insight Seeker 為同一偵查團隊除提供整體案件進度、活動完成情況和任務逾期提醒的即時概覽；亦可由偵查團隊人員分配偵查工作，細部查看個別偵查人員工作負載量與個別偵處進度，支持偵查活動的全面管理。
    * **偵查作為一覽表**：<br>
      作為知識共享和問題解決的核心，這個工作表詳細記錄每一步偵查行動的規劃、進行狀態和結果，包括預計完成日期和逾期提醒，確保案件追蹤的準確性和時效性。這不僅促進了知識共享，還提高了偵查工作的效率和成效。
    * **障礙排除記錄**：<br>
      專門設計來記錄偵查過程中遇到的障礙和延遲原因，這一功能強調了在面對挑戰時的透明度和問題解決策略，促進了團隊間的溝通和協作。
    * **一站式管理與深度整合工具**：<br>
      將常用的網路偵查工具如 WHOIS、PingFromEverywhere 等整合於單一平台，方便快速使用和記錄偵查結果，提升偵查效率。
  * 同仁可搭配 [**Chiakai's CyberSleuths: Digital Detective Challenge**](https://chiakai.pse.is/CyberSleuths) 這個專為訓練網路科技犯罪偵查而設計之事件擬真遊戲，透過各種隨機生成之網路犯罪事件，逐一學習如何進行相關調查與管理相關偵查作為。
  * 說明GIF動畫(載入需一些時間)：
    * ![](https://chiakai-chang.github.io/tempHTML/img/AIInsightSeeker.gif) 

---

# <span style="background-color:yellow;"> ☆☆☆ 科技偵查指令秘笈 ☆☆☆ </span>
* ## [現場勘查參考(操作系統Log與指令)](https://hackmd.io/@chiakai/OSnCMD)
* ## 網頁勘查_DevTools Console 可用指令
  * ### [必須先做] 請先「手動」輸入以下指令，才會被允許在 DevTools 的 Console 內貼上程式碼:
    ```javascript
    allow pasting
    ```
    * 或者見到 Console 出現以下警示的時候，也請「**手動**」輸入上記指令
      ![](https://chiakai-chang.github.io/tempHTML/img/allowpasting.png)
  * ### 列舉出網頁中「所有圖片連結 」(即\<img\>)
    ```javascript
    document.querySelectorAll('img').forEach(target_tag => {console.log(target_tag.src);});
    ```
  * ### 列舉出網頁中「所有影片連結」(即\<video\>)
    ```javascript
    document.querySelectorAll('video').forEach(target_tag => {console.log(target_tag.src);});
    ```
  * ### 列舉出網頁中「所有連結」(即\<a\>) 
    ```javascript
    document.querySelectorAll('a').forEach(target_tag => {console.log(target_tag.href);});
    ```
* ## ☆ 快速點「簿冊傳閱」(勤教) 密技 ☆
  * 步驟:
    * 1、開啟到「值班臺應勤簿冊電子化系統」-「簿冊傳閱」的網頁
    * 2、按「F12」開啟DevTools，選「Console」頁籤
    * 3、在「>」後面輸入以下指令，然後按 「Enter」鍵，瞬間就可以幫你全部點完
  * 指令:
    ```javascript
    document.querySelectorAll('#btnDetail').forEach(button => button.click());
    ```
* ## ☆ 下載「PDF」簡報檔密技 ☆
  * 步驟:
    * 1、使用 Chrome 到教育訓練網站，選擇你的課程，直到打開簡報檔的網頁
    * 2、點右上角的「⋮」 -> 選「更多工具」 -> 選「開發人員工具」(即 DevTools)
    * 3、「開發人員工具」(即 DevTools) 跳到「Network」頁籤，點上方「∅」符號清空目前封包
    * 4、回到網頁，按 F5 重新整理
    * 5、「Network」頁籤會攔到「getPDF.php?id=...」的封包，請看該封包的「Request URL」，其中的「id=...」跟「&ticket=...」中的...就是我們需要的資料
    * 6、請將以下指令中的 id=... 跟 ticket=... 中的 ... 替換成你取到的資料
        * 指令:
           ```javascript
           var link = document.createElement('a'); link.href = "getPDF.php?id=...&ticket=..."; link.download = 'document.pdf'; document.body.appendChild(link); link.click(); document.body.removeChild(link);
           ```
    * 7. 將上述指令修改後，貼到 Console 執行，稍等一下就會跳出視窗問你 PDF 要下載到哪了 
  * 例圖:
    * ![](https://chiakai-chang.github.io/tempHTML/img/downloadPDFpng.png)

* ## ☆ 臉書「自動留言展開」密技 ☆
  * 透過這段小小的代碼，就可以輕鬆展開臉書貼文中所有的留言跟留言中的留言，以及需要展開的長留言內容，完成後，即可很便利的透過 Chrome 來將該則貼文以及全部留言內容，列印成 PDF 保存
  * 步驟:
      * 1、使用 Chrome 到瀏覽到你的目標臉書貼文
      * 2、記得將「最相關」留言的選項，改成「從新到舊」(按時間序比較好核對留言內容，或「所有留言」也可以)，才能截到完整留言
      * 3、點右上角的「⋮」 -> 選「更多工具」 -> 選「開發人員工具」(即 DevTools)
      * 4、「開發人員工具」(即 DevTools) 跳到「Console」頁籤，點上方「∅」符號清空畫面以利觀看
      * 5、請將以下指令貼上後按 enter 執行即可，完成後會跳出視窗 (若無法貼上，請參考 [allow pasting 的教學](https://chiakai-chang.github.io/CKTools/#%E5%BF%85%E9%A0%88%E5%85%88%E5%81%9A-%E8%AB%8B%E5%85%88%E6%89%8B%E5%8B%95%E8%BC%B8%E5%85%A5%E4%BB%A5%E4%B8%8B%E6%8C%87%E4%BB%A4%E6%89%8D%E6%9C%83%E8%A2%AB%E5%85%81%E8%A8%B1%E5%9C%A8-devtools-%E7%9A%84-console-%E5%85%A7%E8%B2%BC%E4%B8%8A%E7%A8%8B%E5%BC%8F%E7%A2%BC))

```javascript
function autoExpandContent() {
    // 定義需要點擊的文字模式（包含中文與英文的常見狀況）
    const replyPattern = /查看.*回覆|View \d+ replies/;
    const morePattern = /查看更多|See more/;
    let previousHeight = 0; // 紀錄目前的網頁高度
    let attempts = 0; // 追蹤嘗試次數
    const maxAttempts = 5; // 最多嘗試5次

    function clickElements() {
        const elements = [...document.querySelectorAll('a, button, span, div')].filter(el => {
            if (!el.offsetParent) return false;
            const text = el.innerText || el.textContent;
            return text && (replyPattern.test(text) || morePattern.test(text));
        });

        elements.forEach(el => {
            el.click();
        });

        return elements.length > 0;
    }

    function autoScroll() {
        window.scrollTo(0, document.body.scrollHeight);
    }

    function executeActions() {
        const hasClicked = clickElements();
        autoScroll();

        setTimeout(() => {
            const currentHeight = document.body.scrollHeight;
            if (currentHeight > previousHeight || hasClicked) {
                previousHeight = currentHeight;
                attempts = 0;
                executeActions();
            } else {
                attempts++;
                if (attempts < maxAttempts) {
                    executeActions();
                } else {
                    alert('所有內容已展開');
                }
            }
        }, 1000);
    }

    executeActions();
}
autoExpandContent(();
```

* ## ☆ 臉書「自動留言展開」+「自動關鍵字搜尋」密技 ☆
  * 這段代碼可以幫忙將臉書貼文的留言類型改成「所有留言」，接著會快速自動下滑與展開臉書貼文所有的留言跟留言中的留言，完成後，還會自動幫忙比對程式碼中「searchKeywords」裡面你所設定的關鍵字是否存在(**記得要去修改！！**)，若有存在會跳窗告知你
  * 步驟:
      * 1、使用 Chrome 到瀏覽到你的目標臉書貼文
      * 2、按「分享」按鈕，選「複製連結」，到另一個視窗去開這篇貼文
      * 3、點右上角的「⋮」 -> 選「更多工具」 -> 選「開發人員工具」(即 DevTools)
      * 4、「開發人員工具」(即 DevTools) 跳到「Console」頁籤，點上方「∅」符號清空畫面以利觀看
      * 5、將以下指令貼上後按 enter 執行即可 (若無法貼上，請參考 [allow pasting 的教學](https://chiakai-chang.github.io/CKTools/#%E5%BF%85%E9%A0%88%E5%85%88%E5%81%9A-%E8%AB%8B%E5%85%88%E6%89%8B%E5%8B%95%E8%BC%B8%E5%85%A5%E4%BB%A5%E4%B8%8B%E6%8C%87%E4%BB%A4%E6%89%8D%E6%9C%83%E8%A2%AB%E5%85%81%E8%A8%B1%E5%9C%A8-devtools-%E7%9A%84-console-%E5%85%A7%E8%B2%BC%E4%B8%8A%E7%A8%8B%E5%BC%8F%E7%A2%BC))

```javascript
function autoExpandContent() {
    // 定義需要點擊的文字模式（包含中文與英文的常見狀況）
    const replyPattern = /查看.*回覆|View \d+ replies/;
    const morePattern = /查看更多|See more/;
    let previousHeight = 0; // 紀錄目前的網頁高度
    let attempts = 0; // 追蹤嘗試次數
    const maxAttempts = 5; // 最多嘗試5次
    const searchKeywords = ["某甲", "某乙", "某丙"]; // 關鍵字列表 (記得要修改，都不需要也可以刪掉留 [] 就好，就是單純展開留言)
    let foundMatches = []; // 儲存找到的匹配結果
    // 檢查是否存在 "最相關" 按鈕並嘗試點擊，切換為 "所有留言"
    function switchToAllComments() {
        const mostRelevantButton = [...document.querySelectorAll('div[role="button"]')]
            .find(el => el.innerText.includes("最相關"));
        if (mostRelevantButton) {
            mostRelevantButton.click(); // 點擊 "最相關" 按鈕
            
            setTimeout(() => {
                // 等待選單出現後，查找更精確的 "所有留言" 選項並點擊
                const menuItems = document.querySelectorAll('div[role="menuitem"]');
                const allCommentsOption = [...menuItems].find(el => {
                    const text = el.innerText || el.textContent;
                    // 使用更精確的條件來識別 "所有留言"，並排除其他選項
                    return text.includes("所有留言") && !text.includes("由新到舊");
                });
                
                if (allCommentsOption) {
                    allCommentsOption.click(); // 點擊 "所有留言" 選項
                    console.log("已自動切換至 '所有留言'");
                    executeActions(); // 切換成功後執行內容展開
                } else {
                    alert("未找到 '所有留言' 選項，請手動切換後重新執行程式。");
                }
            }, 500); // 延遲以確保選單已加載
            return true; // 表示已嘗試切換
        }
        return false; // 無需切換
    }
    // 自動點擊符合條件的元素
    function clickElements() {
        const elements = [...document.querySelectorAll('a, button, span, div')].filter(el => {
            if (!el.offsetParent) return false;
            const text = el.innerText || el.textContent;
            return text && (replyPattern.test(text) || morePattern.test(text));
        });
        elements.forEach(el => {
            el.click();
        });
        return elements.length > 0;
    }
    // 搜索關鍵字並收集匹配的內容
    function searchForKeywords() {
        const textElements = [...document.querySelectorAll('div, p, span')];
        
        textElements.forEach(el => {
            const text = el.innerText || el.textContent;
            searchKeywords.forEach(keyword => {
                if (text.includes(keyword) && !foundMatches.includes(keyword)) {
                    foundMatches.push(keyword);
                }
            });
        });
    }
    // 自動滾動頁面底部並處理浮動滾動元素
    function autoScroll() {
        window.scrollTo(0, document.body.scrollHeight); // 滾動到頁面底部
        const scrollableElements = document.querySelectorAll('*');
        const scrollDistance = 200;
        const scrollInterval = 100;
        scrollableElements.forEach((element) => {
            if (element.scrollHeight > element.clientHeight) { // 若元素可滾動
                const interval = setInterval(() => {
                    element.scrollBy(0, scrollDistance);
                    if (element.scrollTop + element.clientHeight >= element.scrollHeight) {
                        clearInterval(interval);
                        console.log("已到達元素底部");
                    }
                }, scrollInterval);
            }
        });
    }
    // 持續執行點擊與捲動操作，直到所有內容展開
    function executeActions() {
        const hasClicked = clickElements();
        autoScroll(); 
        setTimeout(() => {
            const currentHeight = document.body.scrollHeight;
            if (currentHeight > previousHeight || hasClicked) {
                previousHeight = currentHeight;
                attempts = 0;
                executeActions();
            } else {
                attempts++;
                if (attempts < maxAttempts) {
                    executeActions();
                } else {
                    // 若有設定關鍵字，則進行關鍵字搜尋，否則顯示已全部展開
                    if (searchKeywords.length > 0) {
                        searchForKeywords();
                        if (foundMatches.length > 0) {
                            alert(`找到以下匹配的關鍵字:\n${foundMatches.join('\n')}`);
                        } else {
                            alert('未找到匹配的關鍵字');
                        }
                    } else {
                        alert('所有內容已展開');
                    }
                }
            }
        }, 1000);
    }
    // 首先檢查是否需要切換至 "所有留言"，若無法自動切換則提示使用者手動操作
    if (!switchToAllComments()) {
        executeActions(); // 若不需要切換或已完成切換，則執行展開內容
    }
}
// 啟動自動展開Facebook貼文與留言的功能並搜尋關鍵字
autoExpandContent();
```

---

# <span style="background-color:yellow;"> ☆☆☆ 精心研發各種線上 AI 智慧偵查小幫手 ☆☆☆ </span>
* ## 全新! [CrossCaseSolver 跨境偵查小助手](https://chiakai.pse.is/CrossCaseSolver_POE)
  * [![](https://chiakai-chang.github.io/tempHTML/img/CBIA.png)](https://chiakai.pse.is/CrossCaseSolver_POE)
  * 因網路犯罪愈發頻繁，使用境外IP如 VPN、Web Hosting 等躲避查緝的情形也愈發常見。為貫徹刑案偵查並尋求突破可能，特別開發此工具協助同仁在跨國調閱資料時，幫忙提醒應注意事項、提供調閱之建議，並以該國適當的用詞用語協助撰寫資料調閱之 Email，藉以降低同仁跨境追查之協調困難，提升同仁突破困境之意願。
  * 特色:
    * 1、協助偵辦跨國案件的 Email 撰寫。
    * 2、會幫忙提醒要注意時區等等。
    * 3、不知道可以調什麼，也可以幫你想。
    * 4、一次產多國語言都可以。
    * 5、還會幫你使用跨國適當的用詞用語。
  * 趕快來試用看看吧!!
  * 當前有兩個版本：
    * ### (新!) [Open AI 平臺](https://chiakai.pse.is/CrossCaseSolver)
      * 語言模型：GPT-4o
      * 收費：(可能)需有 ChatGPT Plus 資格(20美元/月)
    * ### (免費!) [POE 平臺](https://chiakai.pse.is/CrossCaseSolver_POE)
      * 語言模型：GPT-4o-Mini 
      * 次數限制：15點/訊息 (POE提供每日免費3000點)
  * 範例:
    <table>
      <tr>
        <td><img src="https://chiakai-chang.github.io/tempHTML/img/CBIA_Start.png" width="250" height="250"></td>
        <td><img src="https://chiakai-chang.github.io/tempHTML/img/CBIA_Chinese.png" width="250" height="250"></td>
      </tr>
      <tr>
        <td><img src="https://chiakai-chang.github.io/tempHTML/img/CBIA_Japanese.png" width="250" height="250"></td>
        <td><img src="https://chiakai-chang.github.io/tempHTML/img/CBIA_English.png" width="250" height="250"></td>
      </tr>
      <tr>
        <td><img src="https://chiakai-chang.github.io/tempHTML/img/CBIA_China.png" width="250" height="250"></td>
        <td></td>
      </tr>
    </table>

* ## 全新改版! [Code Investigater AI 隨身程式碼鑑識小幫手](https://chiakai.pse.is/CodeInvestigatorAI)
  * [![](https://chiakai-chang.github.io/tempHTML/img/Cute_CODE_INVESTIGATOR_AI.png)](https://chiakai.pse.is/CodeInvestigatorAI)
  * 為解決執行數位鑑識現場勘查時，遇到「開發人員」相關現場充斥複雜難懂之各種程式碼的問題，該問題令現場查緝人員難以快速瞭解掌握涉案情形或釐清現場人員所言是否真實，特別開發此工具，提供快速分析程式碼並產出報告的功能，協助現場快速掌握涉案狀況。
  * 特色:
    * 1、可以直接將程式文檔上傳(如 .html、.py、.bat、.sh、.ps1等)，不用複製貼上。
    * 2、經歷數個月 N 輪的 Promt Engineering (提示工程)實測，目前可實現分析程式並給出以下報告內容: 
      * (1) 辨識是哪一種程式語言
      * (2) 分析程式功能概要
      * (3) 分析程式執行分析、函數名稱與程式碼出處(區分自動、手動的函數與類別區塊)
      * (4) 分析程式作者撰寫與變數命名之風格/特徵
      * (5) 分析並嘗試找出程式內留之相關聯絡資訊
      * (6) 分析並嘗試找出程式內之登入資訊(如帳號,密碼,Token等數位憑證)
      * (7) 分析並嘗試找出程式內之網路資訊(如IP、Port、路徑):
      * (8) 分析程式有無加密動作
      * (9) 分析程式是否有惡意程式碼
      * (10) 分析程式之網路交互作用(如從何處取得資料或將資料傳輸至何處)
      * (11) 分析程式是否存在資料混淆
      * (12) 分析程式是否有可疑/違法活動並總結出摘要
      * (13) 提供偵查建議
  * 趕快來試用看看吧!!
  * 當前有兩個版本：
    * ### (新!) [Open AI 平臺](https://chiakai.pse.is/CodeInvestigatorAI)
      * 語言模型：GPT-4o
      * 收費：(可能)需有 ChatGPT Plus 資格(20美元/月)
    * ### (免費!) [POE 平臺](https://chiakai.pse.is/CodeInvestigatorPOE)
      * 語言模型：GPT-4o-Mini-128k 
      * 次數限制：75點/訊息 (POE提供每日免費3000點)

* ## 全新改版! [Insight Profiling Detective Assistant (智慧剖繪偵查助手)](https://chiakai.pse.is/IPDA)
   * [<img src="https://chiakai-chang.github.io/tempHTML/Icons/InsightProfilingDetectiveAssistant.png" width="200" height="200">](https://chiakai.pse.is/IPDA)
   * 緣起:
     * 執行網路案件偵查時，IP 的追查有時候是境外的大家就自動忽略了，但其實 [IKnowWhatYouDownload.com](https://iknowwhatyoudownload.com) 網站有提供 IP 對應下載過的 BT 紀錄，還是可以幫忙了解一下該 IP 使用者的一些習性，包括上網時間(是否比較屬於哪個時區的人)、下載的檔案是比較偏哪個語系、是不是都是很專業的工具軟體、是哪方面的專業，還是只是影音娛樂等等。
     * 原本 Colab 版:  [洞察 IP 下載 BT 紀錄 AI 小幫手](https://chiakai.pse.is/AIBTinsight)
       * 因為該網站沒有提供下載成 Excel 或 CSV 格式，且複製到 Excel 都無法正確對應。
       * 而且下載後，還有需要分析該 IP 使用者作息時間與下載內容剖繪。
       * 故設計這個小幫手幫忙，除自動下載以外，並利用 AI 幫忙分析(由 Chat-GPT 幫忙的唷，感謝 g4f 套件的開發團隊，但是他們是逆向人家的 API，好像也不太適合推崇，大家默默的...使用就好)，讓大家輕鬆偵查。
   * 「**ＮＥＷ 新版！**」專業的科技犯罪偵查專家，幫助員警分析IP下載BT紀錄，快速掌握目標對象的活動規律、興趣偏好和潛在犯罪風險。簡單操作，高效偵查，助你迅速破解案件。
     **功能亮點：**
     - **數據整理**：自動生成互動式表格，清晰呈現下載紀錄。
     - **作息分析**：統計每日、每周作息時間，推測目標行為規律。
     - **偏好剖析**：分析下載內容，揭示興趣偏好與技術能力。
     - **風險評估**：檢查非法下載，判斷犯罪傾向。
     - **深入剖繪**：全面剖析目標對象的人格特徵和人口屬性。
   * 立即免費使用 [Insight Profiling Detective Assistant](https://chiakai.pse.is/IPDA)，讓偵查工作更輕鬆、更高效！
     * ### [ChatGPT 版連結](https://chiakai.pse.is/IPDA)
       * 語言模型：GPT-4o
       * 收費：(可能)需有 ChatGPT Plus 資格(20美元/月)
     * ### [POE 版連結](https://chiakai.pse.is/IPDA_POE)
       * 語言模型：GPT-4o-Mini 
       * 次數限制：15點/訊息 (POE提供每日免費3000點)

---

# <span style="background-color:yellow;"> ☆☆☆ 精心研發各種小幫手程式 (點擊程式名稱即可下載) ☆☆☆ </span>
* ## [IPwhois好好查](https://chiakai-chang.github.io/CKTools/Tools/IPwhoisTool.zip)
  * 當前版本： 20240403_2 [點我下載](https://chiakai-chang.github.io/CKTools/Tools/IPwhoisTool.zip)
  * 一般案件偵查時，針對 IP 使用紀錄通常有幾十到上百的 IP 要逐筆手動查詢 Whois，再轉貼到 Excel 中，往往查完到整理好可以申請投單調閱就已耗時2小時以上；甚至在從事 log 分析時，還可能面臨有多達百萬、甚至上千萬行的資料與 IP，以人力是不可能完成的困境(以舊版的 IP Whois 好好查仍需耗費約連續60~80小時才能查完)。因此特別設計、改進此程式，讓大家自由貼上任意文本資料，程式將自動從每一行資料中，將 IP 抽取出來彙整，並以「即時更新離線資料庫」搭配精心設計的「二分搜尋演算法 (Binary search algorithm)」來加速，自動進行 IP Whois 查詢(若係臺灣 IP 還會再進一步自動查詢 TWNIC 資料)，最後將結果整理成「Excel 一覽表」+「臺灣 IP 基資投單格式 TXT 檔」，其中惱人的 IPv6 也會自動幫大家轉換成符合投單系統可以吃的格式。力求從各種面向，以最貼心的方式，大量節約同仁查詢所需耗費的寶貴時間與精力。
  * 解壓縮密碼：`htciu`
  * [![](https://chiakai-chang.github.io/CKTools/img/ipwhois_poc.png)](https://chiakai-chang.github.io/CKTools/Tools/IPwhoisTool.zip)

---

# <span style="background-color:yellow;"> ☆☆☆ 精心研發各種小幫手程式 (Colab 即取即用，點擊程式名稱即可開啟) ☆☆☆ </span>
* ## [Pimeyes 以圖搜人神器](https://chiakai.pse.is/Pic2UserSearch)
   * 參考: [Pimeyes_Free_POC](https://github.com/addycb/Pimeyes-Free-POC)。
   * 若手頭上的圖檔太小或解析度不夠，可以下載開源免費的軟體: [Upscayl](https://github.com/upscayl/upscayl) 來進行超解析處理。
     * [下載連結](https://upscayl.org/download)
   * 使用時注意:
     * 上傳的圖片最好裁切到只剩1個人，若圖片同時存在多人，透過 API 的方式去搜尋可能會不知道針對哪個對象在查找，出來的結果會比較不好解釋。
     * 本來每次要解開 Pimeyes 搜尋結果都需要付費 **US$15.74** (約新臺幣 **505** 元，參考:[Pricing](https://pimeyes.com/en/premium))，剛好發現有人分享可以利用的漏洞([Pimeyes_Free_POC](https://github.com/addycb/Pimeyes-Free-POC))，目前可以免費獲得搜尋結果中「**沒有打馬賽克的圖片的網址**」(原本搜尋結果會有馬賽克)，但，其實最重要的是圖片「**所在網站網址**」還是沒有給完整。儘管如此，有未馬賽克的圖片就還可以另外用其他 Reverse Image Search 的工具以圖搜圖(例如: [Google Lens](https://www.google.com/)、[TinEye](https://www.tineye.com/)、[FaceCheck.ID](https://facecheck.id)等)增加更多線索來源，算是還蠻有幫助了。
   * 免責聲明:
     * 本程式僅供學術研究及合法測試用途。請勿將本程式用於未經授權的攻擊行為、入侵行為或其他違法活動。使用本程式所造成的任何後果，使用者須自行承擔風險及責任。
     * 開發者不對使用本程式引起的任何直接或間接損失、損害、數據遺失或其他損害負責。使用者應遵守所屬法律法規，並確保在合法的範圍內進行測試及研究。
     * 如有違反當地法律規定，請自行負擔一切法律責任。使用本程式即表示您已同意本免責聲明中的所有條款。

* ## [臉書留言整理神器](https://colab.research.google.com/drive/1t4xkYcXG0apHxFmjXqOPpR_cHpKwtfxV?usp=sharing)
   * 最近網路相關案件越來越多，臉書上假消息、恐嚇、不當發文等等也是越發頻繁，若是假帳號或相關資料很少的帳號發文，或者由他人轉 PO 的文章，常常都有需要從該貼文的留言內容，嘗試看看有無其他線索的需求。但相關留言內容如果要一筆一筆手動瀏覽再複製貼上，實在是很費力，所以特別撰寫這個小程式來幫忙大家。
   * 本程式會自動幫忙整理出以下臉書留言資訊：
     * 1、留言者名稱
     * 2、留言者臉書連結
     * 3、留言者臉書ID
     * 4、留言時間 (技術問題，暫時只能粗略時間，沒有準確時間)
     * 5、留言內容
     * 6、圖片URL (匯出的 xlsx 內會包含留言內的圖片) *新！
     * 7、是否為頭號粉絲 *新！
   * 使用方法：
     * 1、用 Chrome 登入臉書瀏覽到你要爬取的臉書貼文
     * 2、建議按「分享」>「複製連結」，到新的頁面貼上網址，打開該則貼文
     * 3、參考：「[☆ 臉書「自動留言展開」+「自動關鍵字搜尋」密技 ☆](https://chiakai-chang.github.io/CKTools/#-%E8%87%89%E6%9B%B8%E8%87%AA%E5%8B%95%E7%95%99%E8%A8%80%E5%B1%95%E9%96%8B%E8%87%AA%E5%8B%95%E9%97%9C%E9%8D%B5%E5%AD%97%E6%90%9C%E5%B0%8B%E5%AF%86%E6%8A%80-)」將所有留言都自動展開
     * 4、繼續使用 DevTools (開發者工具)，將網頁原始碼複製起來。
     * 5、到下方啟動本程式，將網頁原始碼貼到「HTML內容」欄位
     * 6、按下「解析並產出」按鈕就會自動開始解析與整理了
     * 7、最後可以按「下載檔案」按鈕將本次整理好的 xlsx 檔案下載到您的電腦
       * 若想改預設檔名前墜詞，可到「檔名前綴」欄位修改
       * 預設檔名會是:「facebook_comments_{下載時間}.xlsx」
   * ## [臉書好友整理神器](https://colab.research.google.com/drive/1JCgq0qmmsAtfuICuyk_CciQVjgSfKZ33?usp=sharing)
      * 請參考教學: [使用指引](https://drive.google.com/file/d/1KI8intBMvUYx2rTMgFi2utGGM6oxEH0i/view)
      * 整理大量以往難以人工彙整之臉書留言或按攢者資訊，並用以從事「交集分析」抓出關鍵犯嫌。

* ## [洞察 IP 下載 BT 紀錄 AI 小幫手](https://chiakai.pse.is/AIBTinsight)
   * 緣起:
     * 執行網路案件偵查時，IP 的追查有時候是境外的大家就自動忽略了，但其實 [I Know What You Download](https://iknowwhatyoudownload.com) 網站有提供 IP 對應下載過的 BT 紀錄，還是可以幫忙了解一下該 IP 使用者的一些習性，包括上網時間(是否比較屬於哪個時區的人)、下載的檔案是比較偏哪個語系、是不是都是很專業的工具軟體、是哪方面的專業，還是只是影音娛樂等等。
     * 因為該網站沒有提供下載成 Excel 或 CSV 格式，且複製到 Excel 都無法正確對應。
     * 而且下載後，還有需要分析該 IP 使用者作息時間與下載內容剖繪。
     * 故設計這個小幫手幫忙，除自動下載以外，並利用 AI 幫忙分析(由 Chat-GPT 幫忙的唷，感謝 g4f 套件的開發團隊，但是他們是逆向人家的 API，好像也不太適合推崇，大家默默的...使用就好)，讓大家輕鬆偵查。
   * \[**重要提醒**\] 請務必將本小幫手按以下步驟複製到您的雲端硬碟，再開始執行唷
     * 1. 請按左上角「檔案」
     * 2. 請選「在雲端硬碟中儲存副本」
     * 3. 恭喜，你已經將本小幫手複製到您的雲端硬碟囉

* ## [網路檔案下載取證小幫手](https://chiakai.pse.is/DigitalForensicsFileDownloader)
  * 此小幫手旨在協助您從指定網址下載檔案。主要步驟包括：
    1. 下載並保存檔案。
    2. 同時保存該檔案的「原始封包」。
    3. 對下載的檔案和原始封包計算「雜湊值(HASH)」。
    4. 將上述所有資料壓縮成zip檔，便於封存並下載證據。
  * 使用此小幫手的優點：
    1. 透過 Colab 的虛擬主機進行下載，有效隱藏下載者的 IP 地址和裝置資訊，保護您的隱私。
    2. 結合下載檔案、保存原始封包和雜湊值計算於一體的高效率操作。
    3. 小幫手的程式碼完全開源，無需安裝任何額外套件，使用透明安全。

* ## [IPv6 格式轉換小幫手](https://colab.research.google.com/drive/1we5ASiwmo9hfpVU9fNz0b115R-c0VPL5?usp=sharing)
   * 鑒於 IPv6 位址表示法太長，因此有所謂的以下「省略規則」：
      * 規則1：
         * 為每組數字的第一個0可以省略，若整組皆為0，則以0表示。譬如，「0DB8」可以省略為「DB8」，「0000」則為「0」。
      * 規則2：
         * 為連續出現的0000可以省略成「::」。譬如：「:0000:0000:0000:0000:」可以省略成「:0000:0000:0000::」、「:0:0:0:0:」、「:0::0:」或「::」。
   * 投單調取 IPv6 時，須輸入完整128bits，不可省略「0」，英文部分須為大寫。
      * 範例：2001:B400:E2AD:236A:713E:0BF4:804C:1573
   * 所以特別撰寫這個小程式，幫忙將 IPv6 都轉成符合投單調取的格式

* ## [批量 IP HTTP HEAD 確認小幫手](https://colab.research.google.com/drive/1N559gaAMvCnsKWwK3Y3DPUGDI26JGfNc?usp=sharing)
  * 若您有一批 IP 想了解該 IP 是什麼網站
  * 除了透過 Reverse IP Lookup 查詢 Domain 以外，。
  * 也可以針對該 IP 之 80 (http) 或 443 (https) port 發送 HTTP HEAD 請求。
    * 若該 IP 是 WEB server，就會回應 HTTP Headers，即該網站的 Meta Data，包括：
      * 伺服器類型，如: CloudFlare, Google 等。
      * Location，如： 該網頁的域名。
  * 曾經偵辦案件時取得過某不知身分犯嫌的 IP 連線紀錄，想了解他連線到的 IP 是什麼網站，看有沒有有助於瞭解查明該犯嫌身分的資料，所以撰寫了這個程式。
    * 想到可能對大家也會有幫助，特別釋出給大家使用。

* ## [大量同格式JSON彙整小幫手](https://colab.research.google.com/drive/1w1ApO_p3zh38ocU6jW5di3LXfeQWA3t6?usp=sharing)
  * 現在的網頁大多都基於 MVC 等架構，除了呈現的網頁以外，背後還會用 ajax 等方式用去存取 API 來獲得要更新顯示的資料(大多為 JSON 格式)。
  * 因為前述 JSON 給的資料往往比網頁上肉眼能看到得「更豐富」，且格式也更容易整理，所以有個小幫手可以幫忙將這些 Json 接收下來，一起轉換成更容易操作的 excel 格式，豈不美哉？
  * 本小幫手目前有兩種使用方法，適應不同情境：
    * 用法1: 整理已下載之大量 JSON 檔
    * 用法2: 每次複製貼上1筆，即時換整 JSON 資料再匯出

* ## [視覺化情資網路關聯小幫手](https://colab.research.google.com/drive/1hVI20D5MchN6OuSI8OSC6MVYTDSJclg6?usp=sharing)
  * 現在已有的視覺化分析軟體包括：i2 analyst's notebook、KeyLines 等等，真的非常好用。
  * 但是有以下困擾:
    1. i2 價格實在...門檻太高了。
    2. KeyLines 則需要在公務系統內使用，要比較注意資安稽核等等疑慮。
  * 加上有時候只是單純想要「顯示」情資之間的關聯，用來幫助判斷、分析資料。
  * 所以撰寫了個小程式，讓大家可以隨時隨地「免費的」視覺化自己資料之間的關聯。

* ## [Google IP 確認小幫手](https://colab.research.google.com/drive/1_o9xbFMjlFk1l4VF_7m67gtM9A9IYEjF?usp=sharing)
   * 這個小工具可以幫助您確認某個 IP 位址是否屬於 Google 或 Google Cloud 的服務範圍，並提供該 IP 的相關資訊。
   * 主要功能：
     * **即時資料來源**：此程式會從 Google 官方下載最新的 IP 資訊，包括 [Google API IP address ranges](https://www.gstatic.com/ipranges/goog.json) 和 [Google Cloud IP address ranges](https://www.gstatic.com/ipranges/cloud.json)，確保資料的即時性和準確性。
     * **詳細區域資訊**：程式還會從 [Google Cloud Regions and Zones](https://cloud.google.com/compute/docs/regions-zones) 獲取更多區域和區域的詳細位置信息。
     * **IPv4 和 IPv6 支援**：本程式能處理並查詢 IPv4 和 IPv6 位址。
     * **查詢結果下載**：查詢結果可以下載為 Excel 檔案，方便保存和分享。
   * 使用方法：
     1. 請先按下方「**左側按鈕**」啟動程式，待程式載入即會出現IP輸入框。
     2. 輸入您要查詢的 IP 位址。
     3. 按「查詢」按鈕，等待結果顯示。
     4. 如有需要，可下載查詢結果。
   * 為什麼不直接使用 Whois 查詢？
     * Whois 查詢確實能提供 IP 位址的擁有者資訊，但無法詳細區分 Google 提供的各種服務和區域。這個小工具能讓您：
       * 更精確地識別 IP 是否屬於 Google 或 Google Cloud 的特定服務範圍。
       * 獲得 IP 所屬區域的詳細地理位置信息，便於理解和管理。

* ## [AWS IP 確認小幫手](https://colab.research.google.com/drive/1T7vX0L2gs9VCNzwzSpvsI84rGTFRXl3R?usp=sharing)
   *  若大家有遇到 ip 是 amazon (亞馬遜) 的，可以使用這個小幫手來確認 IP 是 AWS 的什麼雲端服務。
      * 亦可參考 RyanLabs 提供之線上查詢工具：AWS IP Range Checker/Lookup Tool
         * 該工具僅能查詢 IPv4 的資料
   * 本程式係從官方：AWS IP address ranges 下載最新之 IP 資訊 (Json 檔，含 IPv4 與 IPv6) 進行比對，為最即時、最準確之資料

* ## [IP 與 CIDR (網段) 轉換小幫手](https://colab.research.google.com/drive/1DaA5otkgKxl5jZMMYxu8AJaTclpWdHPE?usp=sharing)
  * 因偵辦案件需要設 IP 黑名單阻擋涉案網段，若一個一個 IP 輸入費時費工，有時候 IP Whois 結果又只有提供起始、結束的 IP，還要自己換算成 CIDR 表示法。
  * 故乾脆自己寫一個程式來做轉換，比漫天找網路資源快多了。
  * 只要輸入起始、結束的 IP，就會自動將這之前所有不同的網段，都改以 CIDR 表示法的方式全部列舉出來。

* ## [地址轉經緯度小幫手](https://colab.research.google.com/drive/1BWleXRAN1vM82-k9lz-O78fPMqBZf581?usp=sharing)
  * 借用內政部國土測繪中心「國土測繪圖資服務雲」之電子地圖，查詢任意地址之完整行政區(至村里鄰)及經緯度。 

* ## [User-Agent 解析小幫手](https://colab.research.google.com/drive/1IP1t7yFuIYLnTttwcn_V5fy3XkJASk2d?usp=sharing)
  * 在做 log 分析時，常常都會遇到 User-Agent 這個資料，該資料通常包含了其應用程式類型(瀏覽器)、作業系統、軟體供應商……等等，有時還會包含軟體修訂版本等資訊。
  * 因該字串不容易閱讀，所以特別以小程式幫忙解析重點。

* ## [封包 headers 文字轉 dict 小幫手](https://colab.research.google.com/drive/15auzjfvWt6HICDyKtTDEFfKpoT-TlG7s?usp=sharing)
   * 使用 DevTools 複製找到並複製封包有關 Requests Headers 的文字內容。
   * 貼到程式後，即可整理成方便使用的 dict 格式，並自動將 cookie 分離。

* ## [時間戳轉換小幫手](https://colab.research.google.com/drive/1uzcBbl5EHOn8J5S_UHWQ2_rpfs_Gjttp?usp=sharing)
  * 在做資料清洗、資料探勘時，偶爾會發現有以數字表示的時間(即: 時間戳)。
  * 因為數字的時間戳雖然很方便比較「日期、時間差異」、方便做「時區加減計算」，但是不容易直觀的了解究竟是什麼時間，所以為了方便就寫了個小小小幫手。
  * 本小幫手目前有兩種使用方法，適應不同情境：
    * 用法1: 「時間戳」轉換成「西元日期」
    * 用法2: 「任意日期格式」轉換成「時間戳」

* ## [文字加解密技術](https://colab.research.google.com/drive/1lq6E8jFDKuXveji5zJmzl7m7hT3o3503?usp=sharing)
   * 提供文字有關「凱薩加密」、「二進制轉換」等2種之加解密，尤其是「二進制轉換」時常受資安相關社群隱藏發言所愛用。
   * 包含：
      * 凱撒加密
      * 二進制轉換 (資安社群常用)

---

# <span style="background-color:yellow;"> ☆☆☆ 資料分析處理工具區 ☆☆☆ </span>
* ## Google Sheet: [RE正規表達式套用範本](https://docs.google.com/spreadsheets/d/1qwhzTBiAizzCirTtNPr507Ub5mL4vfr85oOp86BVY5w/edit?usp=sharing)
   * 請參考教學: [使用指引](https://drive.google.com/file/d/1sC3xvlGxVF_IHNsWb78kqXjeRQyLfHHQ/view?usp=sharing)
   * 你可以透過這個範本，並參考相關的「正規表達式」，即能幫您從一行一行的文字資料中(例如: 165案情描述、log檔等等)，批次快速地自動化擷取出例如: 身分證號、手機號碼、市內電話、Email、URL、通訊軟體 ID (Username)等您所需要的關鍵資訊出來。
   * 優點:
     * 使用 Google Sheet 免費，且手機、電腦、平板都能使用。
     * 只要設定好表達式，並貼上一批您要分析的資料，就會一行一行很快速地幫您擷取出來
   * 缺點:
     * 受限於 Google Sheet 的 REGEXEXTRACT 函數，一次只能從您給的分析資料中擷取出第一個符合表達式的關鍵資訊，例如您的給資料中有出現 3 個 IP，就只能擷取出第一個  IP。

---

# <span style="background-color:yellow;"> ☆☆☆ 開源實用工具分享 ☆☆☆ </span>
* ## [WhisperDesktop](https://github.com/Const-me/Whisper) 錄音轉文字軟體
   * 請參考: [使用教學](https://notesstartup.com/youtube-ai-subtitle-tutorial/)
   * 已經為大家打包好實測最好用的模型+程式介面
     * [點我下載(WhisperDesktop.zip)](https://drive.google.com/file/d/1h9Bg9BpWooZMna8ZEieBhokfJJ6b6vXq/view?usp=sharing)
     * 解壓縮密碼: htciu
   * WhisperDesktop 是一款免費、開源的語音轉文字軟體，適用於 Windows 系統。它使用 OpenAI 的 Whisper 語音辨識模型來轉錄音訊和影片。WhisperDesktop 的優點是速度快、準確率高，而且可以支援多種語言，廣東話國語及英語。
   * 小評：
     * 用來快速產生錄音譯文、會議譯文應該是是蠻有幫助的唷！
     * 若錄音檔不在軟體本身預設支援的副檔名內(例如: .agg)而找不到檔案的話，可以先嘗試直接將副檔名改成 .wav 試試看，不行再轉檔就好。
     * 有學長提到在需要通譯陪同的筆錄，未來也許也可以藉由此開源模型去做初步的翻譯，藉以確認通譯所翻譯的譯文是否有正確傳達被詢問者的意思。這部分因為比較需要即時的翻譯，就不適用 WhisperDesktop 這個軟體，只能藉用 OpenAI 開發的 Whisper 語音辨識模型再另外開發，或尋找另外的介面軟體。
   * WhisperDesktop 優點
     * 速度快：WhisperDesktop 可以快速地轉錄音訊和影片。
     * 準確率高：WhisperDesktop 的準確率較高，可以滿足一般需求。
     * 支援多語言：WhisperDesktop 支援多種語言，可以滿足不同使用者的需求。
   * WhisperDesktop 及 OpenAI 的關係
     * WhisperDesktop 是基於 OpenAI 開發的 Whisper 語音辨識模型。OpenAI 是一家非營利性研究機構，致力於開發安全的人工智慧。Whisper 是 OpenAI 開發的一種大型語言模型，可用於語音轉文字、語言翻譯等。


---

# <span style="background-color:yellow;"> ☆☆☆ 人生與職場的心靈雞湯 ☆☆☆ </span>
* ## [智慧心境．蛻變領航．Wisdom Mindset Evolution Navigator](https://chiakai.pse.is/WMEN)
   * [![](https://chiakai-chang.github.io/tempHTML/Icons/WMEN.png)](https://chiakai.pse.is/WMEN)
   * ※ 這是一個基於 ChatGPT4o的GPT 
   * 🌟 提升心靈智慧，解答人生疑惑！ 🌟
       * 親愛的朋友們，我是 Chiakai，誠摯邀請您體驗我獨立設計的智慧心境導師：「智慧心境．蛻變領航．Wisdom Mindset Evolution Navigator」。
無論您遇到什麼困惑，或是需要人生建議，都將為您提供深入的洞察和個性化的指導，助您找到方向。
       * ✨ 功能亮點 ✨
           * 🔍 解答各種人生疑問
           * 🧠 提供專業的心靈指導
           * 🌟 給予實用的人生建議
       * 立即點擊以下連結，開始您的智慧之旅：
           * 👉 [https://chiakai.pse.is/WMEN](https://chiakai.pse.is/WMEN)
       * **提醒您**：
           * 由於此智慧心境導師需連線查資料，若出現連線許可請點選「**允許**」，以確保能為您提供最佳服務。
       * #智慧解惑 #心靈指導 #人生建議 #提升智慧
       
---

# <span style="background-color:yellow;"> ☆☆☆ 再次溫馨提醒您 ☆☆☆ </span>
* 本軍火庫內之各項 **Colab** 或 **Google Sheet** 之工具，相關程式碼或設定全部都係開源透明的，歡迎取用、修改或[回饋改進意見](https://forms.gle/euDVcKwk7QsiHgsz8)。
* <span style="color:red;">**請先記得將工具複製到您的帳號再運作唷!**</span>
  * ### Colab 複製方法:
    * 左上角「**檔案**」->「**在雲端硬碟中儲存副本**」
  * ### Google Sheet 複製方法:
    * 左上角「**檔案**」->「**建立副本**」
   

<script>
    async function getVisitorInfo() {
        try {
            // 調用 https://freeipapi.com/api/json/ API
            const response = await fetch('https://freeipapi.com/api/json/');
            const data = await response.json();

            // 提取所需的信息
            const ip = data.ipAddress;
            const country = data.countryName;
            const cc = data.countryCode;
            const city = data.cityName;
            const timeZone = data.timeZone;
            const latitude = data.latitude;
            const longitude = data.longitude;
            const region = data.regionName;
            const isProxy = data.isProxy;

            // 其他信息
            const userAgent = navigator.userAgent;
            const screenWidth = window.screen.width;
            const screenHeight = window.screen.height;
            const viewportWidth = window.innerWidth;
            const viewportHeight = window.innerHeight;
            const language = navigator.language || navigator.userLanguage;
            const url = window.location.href;

            // 構建 URL 發送到 Google Apps Script
            const scriptUrl = 'https://script.google.com/macros/s/AKfycbwnwH1v8B0FkxSIoS8eFWQOtJxbx3LfgPzv2LePqQOf1wYQDUoQgc7UEv0284pO-kpX9A/exec';
            const fullUrl = `${scriptUrl}?ip=${ip}&country=${encodeURIComponent(country)}&cc=${cc}&city=${encodeURIComponent(city)}&timeZone=${encodeURIComponent(timeZone)}&latitude=${latitude}&longitude=${longitude}&region=${encodeURIComponent(region)}&isProxy=${isProxy}&userAgent=${encodeURIComponent(userAgent)}&screenWidth=${screenWidth}&screenHeight=${screenHeight}&viewportWidth=${viewportWidth}&viewportHeight=${viewportHeight}&language=${language}&url=${encodeURIComponent(url)}`;

            // 發送請求到 Google Apps Script
            fetch(fullUrl)
                .then(response => response.text())
                .then(result => console.log(result))
                .catch(error => console.error('Error:', error));
        } catch (error) {
            console.error('Error:', error);
        }
    }

    // 在頁面加載時調用 getVisitorInfo 函數
    getVisitorInfo();
</script>
